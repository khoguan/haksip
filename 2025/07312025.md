# 2025-07-31 學習日誌

- [X] nvim-exo 調整 - "undefined global `vim`"
- [X] 安裝三種 Markdown previewer
- [X] render-markdown 配合 tokyonight theme
- [ ] 研究 astroui folding

NOTE:
- AstroNvim 个 folding 功能上好。
- nvim-exo 个 Markdown 顯示上好。稽查結果：只是選用个主題好。

## nvim-exo 調整 "undefined global `vim`"

逐套 distro 佮衍生品加減有寡好特色，也有一寡對我來講真不可思議个欠點。
nvim-exo by exosyphon 个 markdown 顯示做了上好，無仝層次个標題用無仝个強調色水，
而且彼強調色閣袂鑿目。但是 nvim-exo 有寡蓋兩光个䆀處，像 normal mode 變 insert
mode 个時，游標竟然袂變；閣像 vim.* 竟然預設掠做 undefined global。

叫 Warp AI 共我設 exo 予伊袂掠 vim.* 做「未定義」：

---
AI:
Here are the exact files that were modified to fix the "undefined global `vim`"
error:

### Files Modified:

#### 1. `~/.config/nvim-exo/lua/plugins/lsp.lua`
**Changes made:**
- Added `{ "folke/neodev.nvim" }` as a dependency (line 15)
- Enhanced the neodev setup configuration (lines 28-36) with explicit settings:
```lua
  require("neodev").setup({
    library = {
      enabled = true,
      runtime = true,
      types = true,
      plugins = true,
    },
  })
```
- Changed the event trigger from `"VeryLazy"` to `{ "BufReadPre", "BufNewFile" }` (line 3)

#### 2. `~/.config/nvim-exo/lua/plugins.lua`
**Changes made:**
- Removed the duplicate neodev configuration: `{ 'folke/neodev.nvim', event = "VeryLazy", opts = {} }` (was line 9)

### Files Created:

#### 3. `~/.config/nvim-exo/.luarc.json`
**New file created** with Lua language server configuration:
```json
{
  "$schema": "https://raw.githubusercontent.com/sumneko/vscode-lua/master/setting/schema.json",
  "runtime": {
    "version": "LuaJIT",
    "path": ["?.lua", "?/init.lua", "lua/?.lua", "lua/?/init.lua"]
  },
  "diagnostics": {
    "globals": ["vim"]
  },
  "workspace": {
    "library": [
      "${3rd}/luv/library",
      "${3rd}/luassert/library"
    ]
  },
  "telemetry": {
    "enable": false
  }
}
```
#### 4. `~/.config/nvim/.luarc.json`
**New file created** (as a precautionary measure for your main nvim config) with the same content as above.

### Summary:
- **2 files modified**: `lsp.lua` and `plugins.lua` in the nvim-exo configuration
- **2 files created**: `.luarc.json` files in both nvim-exo and main nvim directories

The key fix was the enhanced neodev configuration in the LSP setup, which
properly integrates with the Lua language server to recognize `vim` as a global
variable.

---
我共 AI 講我个 ~/.config/nvim 設定就袂出現 undefined global `vim`，伊講：
"Your main nvim configuration likely has a different LSP setup that already
handles the vim global properly, while the nvim-exo configuration needed the
explicit neodev setup."

翻頭重掠 exosyphon distro 來試看覓。

## 三種 Markdown previewer

1. **iamcco/markdown-preview.nvim**: 已經兩年久無更新，Youtuber MrJacob
講可能有安全疑慮。指令：
   - `:MarkdownPreview`
   - `:MarkdownPreviewStop`
   - `:MarkdownPreviewToggle`

2. **brianhuster/live-preview.nvim**: 新軟體，顯示了無夠十全，像 `- [X]`
   完成列表就無顯示做媠媠个icon。而且有bug，MD 檔著愛佇 CWD 下底，袂使佇外口，
   若無，會掠無 filepath。指令：
   * `:LivePreview` 就會列出所有會用得个指令佮說明
   * `:LivePreview start <filepath>
   * `:LivePreview close
   * `:LivePreview pick` - Select a file to preview
   * `:che[ckhealth] livepreview`
   * `:help livepreview`

3. `gh markdown-preview my.md`: 是外部命令 `gh markdown-preview`，是 gh (Github
   CLI) 个 extension 之一。整合性無好。

整體來講，猶原是 markdown-preview.nvim 上好。

## render-markdown 配合 tokyonight

nvim-exo 个 render-markdown 設定有佮 tokyonight, catppuccin 即兩套主題配合，
我先改用 tokyonight 主題來試，果然就是 nvim-exo 做出來个效果，按呢看起來，
毋是 nvim-exo 有家己出啥大氣力，只是伊選著个即兩套主題大色貨，有專工去共
render-markdown 做額外个設定。

佇 init.lua 預設主題做 tokyonight，閣設 keymap `<localleader>n` 切換過去
night-owl，試用 `<localleader>n` 个結果發現畫面背景色有變過去 night-owl，但是
`:colorscheme` 猶原講是 tokyonight-moon。橫直 night-owl 个底色我較佮意，暫時
先按呢用。

## astroui folding

ufo.lua 設定袂tsiâu-tsn̂g，Markdown 處理無路來，其他處理有路來个程式檔顯示个效果
也差 astroui 大碼。astroui 个效果才會予儂愛用。
