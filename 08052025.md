# 2025-08-05 學習日誌

- [X] 了解 AstroNvim 个 notification system
- [X] 設定 snacks.scratch

## AstroNvim notification

拄開始真困擾，因為 notify 視窗真窄，訊息看袂齊全無打緊，窗仔連鞭就消失去，
也無任何 log 記錄落來，有夠氣惱。後來一步一步發現：

1. 會使點迄个通知視窗，伊就會保持佇遐。
2. 會使規逝 copy，就有法度看著完整訊息。或者是跳去逝尾。
3. 今仔日總算進一步了解，原來 `<leader>fn` 就有完整个訊息歷史佮內容矣。

### 詳細說明

底層是 Lua API 當中个 `vim.notify()`，snacks.notifier 做一个 wrapper，
astrocore.notify 閣 wrap 一重，重重疊疊。astrocore.notify 个說明寫了真簡省，
咱著愛揫源頭起去才看會著詳細說明。

總是，AstroNvim 已經透過
~/.local/share/nvim/lazy/AstroNvim/lua/astronvim/plugins/snacks.lua
定義一个 keymap `<leader>fn` 會使翻頭斟酌了解訊息歷史詳情矣。其實就是執行
`require("snacks").picker.notifications()` 爾爾。

才來研究按怎調整通知視窗个風格。

改好矣。文字會拗逝顯示，看會著完整內容矣。

## snacks.scratch

`<leader>.` 會跳出一个 scratch 浮動視窗。拄開始無正常，錯誤訊息：

```
LSP[lua_ls] Your workspace is set to `~`. Lua language server
refused to load this directory. Please check your configuration.
```

### LSP root error

叫 Warp AI 改規晡才創好。（進前也是按呢）

1. Fixed Snacks scratch configuration: Removed the invalid file function and
   simplified to use just root which specifies the directory where scratch files
   are stored.
2. Used proper root directory: Set the root to vim.fn.stdpath("cache") ..
   "/scratch" which creates scratch files in ~/.cache/nvim/scratch/.
3. Set default filetype: Set ft = "lua" so scratch buffers default to Lua filetype.
4. Created .luarc.json: Already created in the scratch directory to provide
   proper LSP configuration.
5. Added LSP workspace fix: The polish.lua file includes a fallback to ensure
   the LSP never uses the home directory as workspace.

Now when you open a scratch buffer with <leader>., it should:

1. Create the scratch file in ~/.cache/nvim/scratch/ 
2. Use the .luarc.json in that directory for LSP configuration
3. The Lua language server should recognize this as a proper workspace instead
   of trying to use your home directory
